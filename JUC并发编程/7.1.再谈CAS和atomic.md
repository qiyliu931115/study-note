CAS 比较交换
---

AtomicInteger atomicInteger = new AtomicInteger(5);

atomicInteger.compareAndSet(5,6);

    5是期望原本的值是5，然后把5改成6


CAS的核心：自旋和Unsafe
---

使用volatile修饰value（保证可见性和顺序性）

为了保证原子性 需要使用unsafe调用本地方法

Unsafe根据ValueOffset 就是内存偏移地址获取数据

![img_30.png](img_30.png)


getAndIncrement()方法
---

内部使用do while循环 不断判断期望值和内存中的偏移量做比较，直到比较成功

![img_31.png](img_31.png)