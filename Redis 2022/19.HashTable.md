Hash Table的基本原理
---

Redis 中的哈希表（Hash Table）是一种基于数组的数据结构，用于存储键值对。

哈希表的原理是将键通过哈希函数映射到数组的索引位置，然后将值存储在该位置上。

哈希表的优点在于可以快速地进行键值对的查找、插入和删除操作，时间复杂度为 O(1)。

Redis 中的哈希表是一种开放地址法的哈希表，也称为线性探测哈希表。在哈希表中，每个数组元素可以存储多个键值对，每个键值对通过链表的方式进行存储。

当多个键映射到同一个数组位置时，Redis 会在该位置上的链表中查找对应的键值对。

Redis 中的哈希表会根据键值对的数量和数组的使用情况，动态地调整数组的大小。

当哈希表中的键值对数量超过数组大小的一定比例时，Redis 会将数组大小扩大一倍，然后将所有键值对重新映射到新的数组中。

当数组中的空闲位置超过一定比例时，Redis 会将数组大小缩小一半，然后将所有键值对重新映射到新的数组中。

在 Redis 中，哈希表被广泛地用于存储键值对，例如存储哈希、存储过期时间等。

哈希表的实现原理简单、高效，是 Redis 中的重要数据结构之一。

Hash Table的结构
---

Redis 中的哈希表（Hash Table）是由哈希表节点（Hash Table Node）组成的数组，每个节点包含一个键值对。

哈希表节点的结构如下：

    typedef struct dictEntry {
        void *key;              // 键
        union {
            void *val;          // 值
            uint64_t u64;       // 64 位无符号整数
            int64_t s64;        // 64 位有符号整数
            double d;           // 双精度浮点数
        } v;
        struct dictEntry *next; // 指向下一个哈希表节点，用于解决哈希冲突
    } dictEntry;

哈希表节点包含三个成员：

    key：指向键的指针，键可以是任意类型的数据，例如字符串、整数、浮点数等。
    
    v：值可以是任意类型的数据，例如字符串、整数、浮点数等。值的类型由具体的应用决定。
    
    next：指向下一个哈希表节点的指针，用于解决哈希冲突。当多个键映射到同一个数组位置时，哈希表会在该位置上的链表中查找对应的键值对。

哈希表的结构如下：

    typedef struct dictht {
        dictEntry **table;  // 哈希表节点数组
        unsigned long size; // 哈希表大小
        unsigned long sizemask; // 哈希表大小掩码，用于计算索引值
        unsigned long used; // 哈希表已使用节点数量
    } dictht;

哈希表包含四个成员：

table：指向哈希表节点数组的指针，每个数组元素可以存储多个键值对。

size：哈希表的大小，即哈希表节点数组的长度。

sizemask：哈希表大小掩码，用于计算键的哈希值对应的数组索引值。

used：哈希表已使用节点数量，用于计算哈希表的负载因子，以及判断是否需要对哈希表进行扩容或缩容。